# Clone toolbox:
```bash
cd ~  
git clone https://github.com/gittygetgot/pentest-toolbox  
cd pentest-toolbox  
```
  

# Install toolbox:
```bash
#test it
pip install .    
```


```bash
git clone https://github.com/gittygetgot/pentest-toolbox.git
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
deactivate
```


# Pentest-toolbox:  
```bash
source venv/bin/activate  # On Windows use `venv\Scripts\activate`

# introtext

This is an ongoing toolbox project that will contain simple tools for pentesting.

deactivate
```
  

# Content :
_____________________________
#1. Shodan API Search Script
_____________________________
This Python script allows you to perform searches on Shodan using their API.

Prerequisites & Usage:  
- Get a Shodan API key.  
- Copy the script to your local machine.  
- Ensure you have the shodan Python package installed (pip install shodan).  

Replace 'YOUR_SHODAN_API_KEY' with your actual Shodan API key.

Customize the query variable in the script to specify your search term.

Run the script using Python:
```bash
python shodan_search.py
```

Example
Searching for Apache servers:
```bash
query = 'apache'
results = search_shodan(query)

if 'matches' in results:
    for result in results['matches']:
        print(result)
else:
    print(f"No results found for the query: '{query}'")
```


  
________________________________
#2. Password Brute Force Script
________________________________
This Python script simulates a brute-force attack by attempting to log in to a specified URL with a given username and generated passwords.
- Install Python if not already installed.
- Download the script.
- Run the script using:

```bash
python brute_force_login.py --url <login_url> --user <username> --max-length <max_password_length> --chars <characters> [--rate-limit <delay_in_milliseconds>]
```
Replace <login_url> with the URL of the login page.  
Replace <username> with the username.  
Replace <max_password_length> with the maximum password length.  
Replace <characters> with the characters for password generation.  
Optionally, specify --rate-limit for delay between attempts.  

Example:
python brute_force_login.py --url https://example.com/login --user admin --max-length 8 --chars abcdefghijklmnopqrstuvwxyz0123456789 --rate-limit 1000


  
___________________________________________________________
#3. Brute force Selenium (Web)
__________________________________________________________
This Python script simulates a brute-force attack by automating login attempts on a specified URL using Selenium.

Usage:
- Ensure you have Python installed.  
- Download the script.  
- Install Selenium:  

```bash
pip install selenium
```
Run the script using:
```bash
python brute_force_login.py --url <login_url> --user <username> --max-length <max_password_length> --chars <characters> [--rate-limit <delay_in_seconds>]
```

Example:  
python brute_force_login.py --url https://example.com/login --user admin --max-length 8 --chars abcdefghijklmnopqrstuvwxyz0123456789 --rate-limit 1  


  
__________________________________
#4. Vulnerability Report Generator
__________________________________
This script automates vulnerability report generation from provided vulnerabilities, aiding in quickly summarizing and documenting security issues found during assessments or testing.  

Input Your Vulnerabilities:
- Open the script and add your vulnerabilities. Each entry should include severity, description, and recommended actions.
```bash
vulnerabilities = [
    {"severity": "High", "description": "SQL injection vulnerability", "recommendation": "Sanitize input data."},
    {"severity": "Medium", "description": "Cross-site scripting (XSS) vulnerability", "recommendation": "Use input validation and encoding."},
    {"severity": "Low", "description": "Information disclosure vulnerability", "recommendation": "Limit error messages and sensitive data exposure."},
]
```
Run the Script:
- Execute the script using Python. It will automatically generate a formatted report based on your input.
```bash
  report = generate_vulnerability_report(vulnerabilities)
```

Get Your Report:
- The script will produce a neatly organized report, showing the total number of vulnerabilities and details for each one.


___________
#5. Pylint
___________  
This command will run Pylint on all Python files in the root directory and display any errors or warnings according to Pylint's rules and recommendations directly in the terminal.  

- Open the terminal.  
- Navigate to the root directory of your Python project.  
- Enter the following command and press Enter:  
```bash
pylint *.py
```
This command will run Pylint on all Python files in the root directory and display any errors or warnings according to Pylint's rules and recommendations directly in the terminal.  
It's a quick and easy way to check your Python code and improve its quality and style.  

Advantages:
- Quality Control: Reviews the code to ensure high standards and follow Python conventions.  
- Error Detection: Identifies potential errors and issues in the code.  
- Style Consistency: Helps maintain consistent code style and facilitates code maintenance.  
- Automated Control: Automates code quality control, saving time.  
- Quick Feedback: Provides quick feedback directly in GitHub to address issues and avoid faulty code.



___________
#6. Network scanning
___________  
This Python script allows you to quickly scan a network for active hosts and open ports.

Usage:

- Download: Download the port_scanner.py script to your local machine.
- Setup: Open the script and replace the network variable with your desired network address (e.g., "192.168.1.0/24") and     the ports_to_scan list with the ports you want to scan (e.g., [22, 80, 443]).
- Run: Open a terminal or command prompt in the directory where the script is located and run the following command:

python port_scanner.py


```bash
import socket
import ipaddress

def is_port_open(host, port):
    """Check if a port is open on the given host."""
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(0.5)  # Timeout of 0.5 second
        result = sock.connect_ex((host, port))
        sock.close()
        return result == 0
    except socket.error:
        return False

def scan_host(host, ports):
    """Scan a host for open ports."""
    print(f"Scanning {host}")
    for port in ports:
        if is_port_open(host, port):
            print(f"Port {port} is open on {host}")

def scan_network(network, ports):
    """Scan a network for active hosts and open ports."""
    for ip in ipaddress.IPv4Network(network):
        scan_host(str(ip), ports)

# Example usage
network = "192.168.1.0/24"  # Replace with your network
ports_to_scan = [22, 80, 443]  # Replace with your ports of interest

scan_network(network, ports_to_scan)
```


___________
#7. DNS
___________  

This Python script allows you to easily retrieve DNS records for a given domain name.

Usage:
- Download: Download the dns_record_lookup.py script to your local machine.

- Requirements: Make sure you have the dnspython library installed. You can install it using pip:
  pip install dnspython

- Run: Open a terminal or command prompt in the directory where the script is located and run the following command:
  python dns_record_lookup.py

```bash
pip install dnspython
```

```bash
import dns.resolver

# Function to get A record (IP address)
def get_a_record(domain):
    try:
        result = dns.resolver.resolve(domain, 'A')
        for ipval in result:
            print('A Record:', ipval.to_text())
    except Exception as e:
        print('Error:', e)

# Function to get MX record (Mail server)
def get_mx_record(domain):
    try:
        result = dns.resolver.resolve(domain, 'MX')
        for mail_server in result:
            print('MX Record:', mail_server.exchange.to_text())
    except Exception as e:
        print('Error:', e)

# Function to get NS record (Name servers)
def get_ns_record(domain):
    try:
        result = dns.resolver.resolve(domain, 'NS')
        for nameserver in result:
            print('NS Record:', nameserver.to_text())
    except Exception as e:
        print('Error:', e)

# Test the functions with a domain
domain = 'example.com'
print(f"DNS records for {domain}:")
get_a_record(domain)
get_mx_record(domain)
get_ns_record(domain)
```
______________________________________________________________

___________
#8. TCP lyssnare
___________ 
This Python script starts a TCP server that listens on a given IP address and port. Upon connection from a client, it echoes back any data it receives.

Usage:
- Installation: Ensure you have Python installed on your computer.
- Run the server: Open a terminal and navigate to the directory where server.py is located. Then run the following command:
python server.py
- Connect a client: Use a TCP client to connect to the server at the specified IP address and port.


Example:
python server.py

Configuration
- server_ip: The IP address of the server.
- server_port: The port on which the server listens.

Note
- The server listens for a single connection at a time.
- It echoes back any data received from the client.

```bash
import socket

def start_server(ip, port):
    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server_socket.bind((ip, port))
    server_socket.listen(1)
    print(f"Listening on {ip}:{port}")

    client_socket, client_address = server_socket.accept()
    print(f"Connection from {client_address}")

    while True:
        data = client_socket.recv(1024)
        if not data:
            break
        print(f"Received: {data.decode()}")
        client_socket.sendall(data)

    client_socket.close()
    server_socket.close()

# Run the server
server_ip = '192.168.0.3'
server_port = 12345
start_server(server_ip, server_port)
```

___________
#8. TCP sender
___________ 
This Python script sends a message to a TCP server at a specified IP address and port, then prints the response received from the server.

Usage:
- Installation: Ensure you have Python installed on your computer.
- Run the script: Open a terminal and navigate to the directory where client.py is located. Then run the following command:
python client.py
- Configuration: Edit the server_ip, server_port, and message variables in the script to match your desired server IP, port, and message.

Example: 
python client.py

Note
- This script sends a message to the server and waits for a response.
- Ensure that the server is running and listening on the specified IP address and port.

```bash
import socket

def send_message(ip, port, message):
    client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    client_socket.connect((ip, port))
    client_socket.sendall(message.encode())

    response = client_socket.recv(1024)
    print(f"Received: {response.decode()}")

    client_socket.close()

# Send a message
server_ip = '192.168.0.3'
server_port = 12345
message = "Hello, Server!"
send_message(server_ip, server_port, message)
```


___________
#9. Document vulnerabilities automatically
___________ 
This Python script performs a port scan on a specified host or list of hosts, and generates a report in Microsoft Word (.docx) format.

Usage:
- Installation: Ensure you have Python installed on your computer.
- Dependencies: Install the required dependencies using pip:
  pip install python-docx
- Run the script:
  To scan a single host:
  python port_scanner.py <host>
  To scan multiple hosts via piped input:
  cat hosts.txt | python port_scanner.py


Output:
- The script scans ports in the range from 20 to 1024 by default.
- It generates a report named port_scan_report_<host>.docx for each scanned host.

Note:
- Ensure that you have necessary permissions to perform port scanning on the target host(s).
- The script utilizes TCP SYN scanning to detect open ports.


```bash
import socket
import sys
from docx import Document

def scan_ports(host, port_range):
    open_ports = []
    for port in range(*port_range):
        try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                s.settimeout(1)
                if not s.connect_ex((host, port)):
                    open_ports.append(port)
        except socket.error:
            pass
    return open_ports

def write_report(host, open_ports, filename):
    doc = Document()
    doc.add_heading(f'Port Scan Report for {host}', 0)

    if open_ports:
        doc.add_paragraph('The following ports are open:')
        for port in open_ports:
            doc.add_paragraph(f'Port {port}')
    else:
        doc.add_paragraph('No open ports found.')

    doc.save(filename)

def process_host(host):
    target_port_range = (20, 1025)
    open_ports = scan_ports(host, target_port_range)
    report_filename = f'port_scan_report_{host}.docx'
    write_report(host, open_ports, report_filename)

# Check if any arguments are provided (for single IP) or read from stdin (for piped list)
if len(sys.argv) > 1:
    process_host(sys.argv[1])
else:
    for line in sys.stdin:
        host = line.strip()
        if host:
            process_host(host)
```

